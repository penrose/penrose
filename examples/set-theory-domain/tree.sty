canvas {
  width = 800
  height = 700
}


Colors {
   color black = rgba(0.,0.,0.,1.)
   color red = rgba(1.,0.,0.,1.)
   color green = rgba(0.,.7,0.,1.)
   color blue = rgba(0.,0,1.,1.)
   color white = rgba(1.,1.,1.,1.)
   color lightGray = rgba(.8,.8,.8,1.)
}

Global {
   shape box = Rectangle {
      center: (0.,0.)
      color: none()
      strokeColor: Colors.lightGray
      strokeWidth: 2.
      w: canvas.width
      h: canvas.height
   }

   scalar setRadius = 18.
}

Set x {

   vec2 x.center = (?,?)

    x.icon = Text {
       center: x.center
       string: x.label
       fontFamily: "Courier"
       fontSize: "18pt"
       fontWeight: "bold"
       color: Colors.black
    }

    x.bounds = Circle {
       center: x.center
       r: Global.setRadius
       color: none()
    }
}

Set x; Set y {
   -- Try to make sure no labels overlap
   encourage repel(x.bounds, y.bounds, 5.0)
}

-- TODO: Phase this back in

Set x; Set y
where IsSubset(x, y) {

   vec2 p = x.center
   vec2 q = y.center
   vec2 u = unit(q-p)
   scalar r = Global.setRadius

   arrow = Arrow {
      start: p + r*u
      end: q - r*u
      thickness : 4.0
      color : rgba(0.0, 0.0, 0.0, 1.0)
      arrowheadSize: .5
   }

   -- Draw the arrow from y to x
   --encourage centerArrow(arrow, x.bounds, y.bounds)

   -- Position y above x
   encourage above(y.bounds, x.bounds)

   -- Have sets 'fight' to be aligned with the superset's x-position
   encourage equal(x.bounds.center[0], y.bounds.center[0])
   }

/*
-- TODO: This one currently causes convergence to become very slow but works eventually

Set x1; Set x2
where IsSubset(x1, S); IsSubset(x2, S)
with Set S {
   -- If two sets are direct subsets of the same set, give them the same y-position
   heightFn = ensure sameHeight(x1.bounds, x2.bounds)
}
*/
